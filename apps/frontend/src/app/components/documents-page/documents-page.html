<div class="container mt-4">   
    <div class="row g-4">
        <!-- Left Column - Search and Response -->
        <div class="col-lg-8">
            <!-- Search Section -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-white d-flex align-items-center">
                    <span class="text-muted">Upload, process, and analyze your PDF documents with AI</span>
                </div>
                <div class="card-body">
                    <div class="input-group mb-3">
                        <span class="input-group-text bg-white border-end-0">
                            <i class="bi bi-search text-muted"></i>
                        </span>
                        <input 
                            type="text" 
                            class="form-control form-control-lg border-start-0" 
                            placeholder="Ask questions about your documents..."
                            [(ngModel)]="prompt"
                            (keyup.enter)="onSearch()"
                        >
                        <button class="btn btn-primary" [disabled]="!prompt() || isLoading()" (click)="onSearch()">
                            <i class="bi bi-send me-1"></i> Ask
                        </button>
                    </div>
                </div>
            </div>

            <!-- Search Results Section -->
            @if(promptResult() || isLoading()) {
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-white d-flex align-items-center">
                        <h5 class="mb-0">
                            <i class="bi bi-file-earmark-text me-2 text-primary"></i>AI Response
                        </h5>
                    </div>
                    <div class="card-body">
                        @if(isLoading()) {
                            <div class="text-center py-5">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-3 mb-0">Analyzing documents and generating response...</p>
                            </div>
                        }
                        
                        @if(!isLoading() && promptResult()) {
                            <div class="p-4">
                                <div class="alert alert-light border-0 rounded-3">
                                    <p class="mb-0">{{ promptResult() }}</p>
                                </div>
                            </div>
                        }

                    </div>
                </div>
            }
        </div>

        <!-- Right Column - Upload Section -->
        <div class="col-lg-4">
            <!-- Document Upload Section -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-white d-flex align-items-center justify-content-between">
                    <span class="badge bg-light text-dark">{{ selectedFiles().length }} files selected</span>
                </div>
                <div class="card-body">
                    <!-- Drag and Drop Area -->
                    <div 
                        class="border border-dashed rounded-3 p-5 mb-4 text-center cursor-pointer bg-light hover-bg-primary-light transition-all"
                        (dragover)="onDragOver($event)"
                        (drop)="onDrop($event)"
                        (click)="fileInput.click()"
                    >
                        <i class="bi bi-cloud-upload fs-1 text-primary mb-3 d-block"></i>
                        <h5 class="mb-2">Drag & drop PDF files here</h5>
                        <p class="text-muted mb-3">or click to browse your files</p>
                        <p class="text-muted small mb-0">Supports multiple PDF files (max 10MB each)</p>
                    </div>

                    <!-- Hidden file input -->
                    <input 
                        type="file" 
                        #fileInput
                        class="d-none" 
                        accept=".pdf"
                        (change)="onFileSelected($event)"
                        multiple
                    >

                    <!-- Selected Files List -->
                    @if(selectedFiles().length > 0) {
                        <div class="mt-4">
                            <h6 class="mb-3">Selected Files</h6>
                            <div class="row g-3">
                                @for(file of selectedFiles(); track file.name) {
                                    <div class="col-12">
                                        <div class="card border-light shadow-sm h-100">
                                            <div class="card-body d-flex align-items-center">
                                                <i class="bi bi-file-pdf text-danger fs-4 me-3"></i>
                                                <div class="flex-grow-1">
                                                    <h6 class="mb-1">{{ file.name }}</h6>
                                                    <p class="text-muted small mb-0">{{ (file.size / 1024 / 1024).toFixed(2) }} MB</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    }

                    <!-- Process Button -->
                    <div class="d-grid gap-2 mt-4">
                        <button 
                            class="btn btn-primary btn-lg" 
                            [disabled]="selectedFiles().length === 0 || isProcessing()"
                            (click)="processDocuments()">
                            <i class="bi bi-file-earmark-medical me-2"></i>
                            {{ isProcessing() ? 'Processing Documents...' : 'Process & Upload Documents' }}
                        </button>
                    </div>

                    <!-- Processing Status -->
                    @if(processingStatus()){
                        <div class="mt-3">
                            <div class="alert alert-info border-0 rounded-3 p-3">
                                <i class="bi bi-info-circle me-2"></i>
                                {{ processingStatus() }}
                            </div>
                        </div>
                    }
                    
                    <!-- Upload Status -->
                    @if(uploadStatus() && !processingStatus()){
                        <div class="mt-3">
                            @if(uploadStatus() === 'success'){
                                <div class="alert alert-success border-0 rounded-3 p-3">
                                    <i class="bi bi-check-circle me-2"></i>
                                    All documents processed and uploaded successfully!
                                </div>
                            }
                            @else{
                                <div class="alert alert-danger border-0 rounded-3 p-3">
                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                    Error uploading documents
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
